<style>
.fl{
	float: left;
}
.fr{
	float: right;
}
.lh52{
	line-height: 52px;
}
.m1 {
    width: 30%;
}
.m1 .tu_m {
    margin-left: 10px;
    display: block;
}
.m4{
	width: 10%;
}
.m2{
	width: 15%;
}
.m10{
	width: 10%;
}
.c_font_1{
	color: #7b99ad;
}
.tc{
	text-align: center;
}
.tl{
	text-align: left;
}
.c_tran p:nth-child(1){
    color: transparent;
}



.lineproc-yxb{
	background: #050d19;
	padding-top: 72px;
}
.lineproc-yxb-hed{
	height: 30px;
	padding:0 15px; 
}
.lineproc-yxb-hed h3{
    float: left;
    font-size: 16px;
    color: #e1e1e1;
    position: relative;
    line-height: 16px;
    font-weight: normal;
    padding-left: 10px;
}
.lineproc-yxb-hed h3:before{
    content: '|';
    position: absolute;
    left: 0px;
    border-left: 4px solid #648EDA;
    color: transparent;
}
.lineproc-yxb-hed a{
	float: right;
	color: #848ea4;
	font-size: 14px;
	line-height: 14px;
	letter-spacing: 1px;
}
.lineproc-yxb-hed a i{
    width: 10px;
    height: 10px;
    display: inline-block;
    background: url(../../images/prank-ico.png);
    background-size: 100% 100%;
    vertical-align: middle;
}
.lineProc-jpc-box{
    position: relative;
    padding-top: 50px;
}
.lineProc-jpc{
    min-height: 28px;
    border-bottom: 1px solid #323e56;
    margin-bottom: 15px;
    padding: 0 7% 10px;

}
.lineProc-match-time{
    font-size: 12px;
    line-height: 12px;

}
.lineProc-match-time i{
    display: inline-block;
    width: 12px;
    height: 12px;
    background: url(../../images/nav_ico_3_@3x.png) no-repeat;
    background-size: 100% 100%;
    margin-right: 5px;
    vertical-align: text-top;
}

.lineProc-jpc-prize{
    width: 100%;
    min-height: 150px;
    position: relative;
    font-size: 10px;
    margin-bottom: 20px;
}
.lineProc-jpc-prize .prize{
    position: absolute;
    left: 0;
    top:0;
    width: 12%;
    text-align: center;
}
.lineProc-jpc-prize .prize i{
    display: inline-block;
    width: 14px;
    height: 18px;
    background: url(../../images/ico_jt_1.png) no-repeat;
    background-size: 100% 100%;
}
.lineProc-jpc-prize .prize p{
    
}
.lineProc-jpc-prize .prize p:nth-child(1){
    margin-bottom: 17px;
}
.lineProc-jpc-prize .prize p:nth-child(3){
    font-size: 12px;
}
.lineProc-jpc-prize .prize img{
    margin:10px 0;
}
.lineProc-jpc-prize .prize p:nth-child(5){
    color: #efdf4d;
}
.lineProc-jpc-prize .prize1{
    left: 16.8%
}
.lineProc-jpc-prize .prize2{
    left: 40.5%
}
.lineProc-jpc-prize .prize3{
    left: 61.8%
}
.lineProc-jpc-prize .prize4{
    left: 76.6%
}
.lineProc-jpc-prize .prize5{
    left: 91.37%
}
.lineProc-jpc-bar {
    position: absolute;
    left: 0;
    top: 66px;
    width: 100%;
    height: 17px;
}
.lineProc-jpc-bar .bar2{
    width: 100%;
    height: 100%;
    background: url(../../images/ico_jt_4.png) no-repeat;
    background-size:100% 100%;
    overflow: hidden;
    padding:0 10px;
}
.lineProc-jpc-bar .bar2-1{
    width: 100%;
    height: 9px;
    background: url(../../images/ico_jt_3_022.png) no-repeat;
    background-size: auto 100%;
    margin-top:3px;
    position: relative;
}
.lineProc-jpc-bar .bar2-1:after{
    content: " ";
    width: 14px;
    height: 14px;
    background: url(../../images/ico_jt_2.png) no-repeat;
    background-size: 100% 100%;
    display: inline-block;
    position: absolute;
    right: -2px;
    top: -2px;
}
.lineProc-jpc-bar .bar1{
    text-align: center;
    font-size: 10px;
    color: #fad83a;
    width:12%;
    position: absolute;
    left: -3%;
    top: -48px;
}
.lineProc-jpc-bar .bar1 img{
    border-radius: 100%;
    display: inline-block;

}

.lineproc-yxb-list a.user-gameData-item{
    overflow: hidden;
    display: block;
    color: #e1e1e1;
    font-size: 12px;
}
.lineproc-yxb-list a.user-gameData-item:nth-child(2n+1){
	background: #111a2b;
}
.lineproc-yxb-list .c_ph_1{
    width: 24px;
    height: 24px;
    background: url(../../images/prank-ico-01.png) no-repeat;
    background-size: 100% 100%;
    vertical-align: middle;
    display: inline-block;
    font-size: 0;
}
.lineproc-yxb-list .c_ph_2{
    width: 24px;
    height: 24px;
    background: url(../../images/prank-ico-02.png) no-repeat;
    background-size: 100% 100%;
    vertical-align: middle;
    display: inline-block;
    font-size: 0;
}
.lineproc-yxb-list .c_ph_3{
    width: 24px;
    height: 24px;
    background: url(../../images/prank-ico-03.png) no-repeat;
    background-size: 100% 100%;
    vertical-align: middle;
    display: inline-block;
    font-size: 0;
}
.lineproc-yxb-list .item1 {
    padding-top: 11px;
    overflow: hidden;
}
.lineproc-yxb-list .user-img-text {
    margin-left: 10px;
    margin-top:10px;
    max-width: 100%;
    line-height: 12px;
}
.lineproc-yxb-list .c_font_b img{
	display: inline-block;
	vertical-align: middle;
}
.lineproc-yxb-list .c_font_a{
	color: #34a247
}
.lineproc-yxb-list  .tu-link i{
	width: 10px;
	height: 15px;
	display: inline-block;
	background: url(../../images/prank-ico.png);
	background-size: 100% 100%;
	vertical-align: middle;
}
</style>
<template>

    <div class="season-tab">
        <childnav></childnav>
        <div class="season-tab-box">
            <div class="lineproc">
                <div class="lineproc-yxb">
                    <div class="lineproc-yxb-hed">
                        <h3>奖品池</h3>
                        <a v-link="{path:'/mine/'+userid}">我的比赛详情<i></i></a>
                    </div>
                    <div class="lineProc-jpc">
                        <div class="lineProc-jpc-box">
                            <div class="lineProc-jpc-bar">
                                <div class="bar1">
                                    <img src="../../images/prank-timg.png" width="30px">
                                    <p>{{userScore}}分</p>
                                </div>
                                <div class="bar2">
                                    <div class="bar2-1" style="width:2%"></div>
                                    <div class="bar2-2"></div>
                                </div>
                            </div>
                            <div class="lineProc-jpc-prize">
                                <div class="prize prize1">
                                    <p>300分</p>
                                    <i></i>
                                    <p>前100名</p>
                                    <img src="../../images/img_5_@3x.png" width="40px">
                                    <p>幽魂碎片×3</p> 
                                </div>
                                <div class="prize prize2">
                                    <p>500分</p>
                                    <i></i>
                                    <p>前10名</p>
                                    <img src="../../images/img_5_@3x.png" width="40px">
                                    <p>幽魂碎片×3</p> 
                                </div>
                                <div class="prize prize3">
                                    <p>1000分</p>
                                    <i></i>
                                    <p>季军</p>
                                    <img src="../../images/img_3_@3x.png" width="40px">
                                    <p>100元</p> 
                                </div>
                                <div class="prize prize4">
                                    <p>2000分</p>
                                    <i></i>
                                    <p>亚军</p>
                                    <img src="../../images/img_2_@3x.png" width="40px">
                                    <p>500元</p>
                                </div>
                                <div class="prize prize5">
                                    <p>3000分</p>
                                    <i></i>
                                    <p>冠军</p>
                                    <img src="../../images/img_1_@3x.png" width="40px">
                                    <p>1000元</p>
                                </div>
                            </div>
                        </div>
                        <p class="lineProc-match-time" v-if="state==1"><i></i>结束倒计时:{{timestate}}</p>
                        <p class="lineProc-match-time" v-if="state==0"><i></i>未开始</p>
                        <p class="lineProc-match-time" v-if="state==2"><i></i>已结束</p>
                    </div>
                    <div class="lineproc-yxb-hed">
                        <h3>英雄榜</h3>
                        <a v-link="{path:'/mine/'}">查看更多<i></i></a>
                    </div>
                    <div class="lineproc-yxb-list">
                        <a  class="user-gameData-item"  v-for="list in datayxblist"  v-link="{path:'/mine/'+list.userid}">
                            <div class="fl tc m4 lh52 c_font_1">
                                <span class="c_ph_1" v-if="list.ranking == 1"></span>
                                <span class="c_ph_2" v-if="list.ranking == 2"></span>
                                <span class="c_ph_3" v-if="list.ranking == 3"></span>
                                <span class="" v-if="list.ranking > 3">{{list.ranking}}</span>
                            </div>
                            <div class="fl m1 item1">
                                <div class="fl tu_m">
                                    <img width="32" height="32" alt="" class="img" :src=list.icon>
                                </div>
                                <div class="user-img-text user_name fl">
                                    <span class="fl">{{list.username}}</span>
                                </div> 
                            </div>
                            <div class="fl tl lh52 m2">{{list.service}}</div>
                            <div class="fl tc lh52 m2 c_font_a">{{list.integral}}</div>
                            <div class="fl tc lh52 m10 c_font_b"  v-if="list.ranking == 1"><img src="../../images/img_small_@3x.png" width="32px"></div>
                            <div class="fl tc lh52 m10 c_font_b"  v-if="list.ranking == 2"><img src="../../images/img_small_@3x.png" width="32px"></div><div class="fl tc lh52 m10 c_font_b"  v-if="list.ranking == 3"><img src="../../images/img_small_@3x.png" width="32px"></div><div class="fl tc lh52 m10 c_font_b"  v-if="list.ranking > 3"></div> 
                            <div class="fr tc lh52 m4 c_font_b tu-link"><i></i></div> 
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
        
</template>

<script>
var Vue = require('Vue');
var nav = require('./nav.vue');
var $ = require('jQuery');
var common = require('../../js/common.js');

var lineProc = Vue.extend({
    name : 'lineProc',
    data : function() {
        return {
            matchname : wsCache.get('HEROC').matchname,
            channelid : wsCache.get('HEROC').channelid,
            matchid : wsCache.get('HEROC').matchid,
            userid : Miconfig.userid,
            datayxblist:[],
            userScore : '',
            state : '',
            timestate : ''
        };
    },
    components:{
        'childnav':nav
    },
    ready: function() {
        this.yxbFn(10);
        this.jfFn();
        if($(".season-tab-box").height() > ($(window).height()-63)){
            common.scroll(function(direction){
                if(direction=="down"){
                    $(".season-tab-hed1,.season-tab-hed").css("top","-62px");
                }else{
                    $(".season-tab-hed1,.season-tab-hed").css("top","0");
                }
            }); 
        };
    },
    methods: {
        yxbFn:function(pageS){
            var vm = this;
            $.ajax({
                url:common.getBaseUrl(),
                type:"GET",
                data:{category:"lineProc",type:"1",pageproc:pageS,userid:vm.userid},
                dataType:"json",
                success:function(data){
                    vm.datayxblist = vm.datayxblist.concat(data.yxblist)
                }
            })
        },
        jfFn:function(){
            var vm = this;
            console.log(vm.userid)
            $.ajax({
                url:common.getBaseUrl(),
                type:"GET",
                data:{category:"lineProcjf",userid:vm.userid,matchid:vm.matchid},
                dataType:"json",
                success:function(data){
                    vm.userScore = data.score;
                    vm.state = data.state;
                    vm.timestate = data.timestate;
                    switch(true){
                        case  vm.userScore==0 :
                            $(".bar2-1").css("width","2%");
                            $(".lineProc-jpc-prize .prize").removeClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","-3%");
                        break;
                        case  vm.userScore<50 && vm.userScore>0 :
                            $(".bar2-1").css("width","7%");
                            $(".lineProc-jpc-prize .prize").removeClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","2%");
                        break;
                        case  vm.userScore>50&&vm.userScore<300 :
                            $(".bar2-1").css("width","12%");
                            $(".lineProc-jpc-prize .prize").removeClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","7%");
                        break;
                        case  vm.userScore==300 :
                            $(".bar2-1").css("width","22.8%");
                            $(".lineProc-jpc-prize .prize1").addClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","17.2%");
                        break;
                        case  vm.userScore>300&&vm.userScore<500 :
                            $(".bar2-1").css("width","35%");
                            $(".lineProc-jpc-prize .prize").removeClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","29%");
                        break;
                        case  vm.userScore==500 :
                            $(".bar2-1").css("width","47.2%");
                            $(".lineProc-jpc-prize .prize2").addClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","40.5%");
                        break;
                        case  vm.userScore>500&&vm.userScore<1000 :
                            $(".bar2-1").css("width","57%");
                            $(".lineProc-jpc-prize .prize").removeClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","50.5%");
                        break;
                        case  vm.userScore==1000 :
                            $(".bar2-1").css("width","69.3%");
                            $(".lineProc-jpc-prize .prize3").addClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","62%");
                        break;
                        case  vm.userScore>1000&&vm.userScore<2000 :
                            $(".bar2-1").css("width","76.3%");
                            $(".lineProc-jpc-prize .prize").removeClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","69%");
                        break;
                        case  vm.userScore==2000 :
                            $(".bar2-1").css("width","84.6%");
                            $(".lineProc-jpc-prize .prize4").addClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","76.6%");
                        break;
                        case  vm.userScore>2000&&vm.userScore<3000 :
                            $(".bar2-1").css("width","91.6%");
                            $(".lineProc-jpc-prize .prize").removeClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","84%");
                        break;
                        case  vm.userScore>=3000 :
                            $(".bar2-1").css("width","99.9%");
                            $(".lineProc-jpc-prize .prize5").addClass("c_tran");
                            $(".lineProc-jpc-bar .bar1").css("left","92%");
                        break;
                    }
                }
            }) 
        }
    }
});

module.exports = lineProc;
</script>