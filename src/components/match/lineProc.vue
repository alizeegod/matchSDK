<style>
.fl{
	float: left;
}
.fr{
	float: right;
}
.lh52{
	line-height: 52px;
}
.m1 {
    width: 30%;
}
.m1 .tu_m {
    margin-left: 10px;
    display: block;
}
.m4{
	width: 10%;
}
.m2{
	width: 15%;
}
.m10{
	width: 10%;
}
.c_font_1{
	color: #7b99ad;
}
.tc{
	text-align: center;
}
.tl{
	text-align: left;
}
.c_tran p:nth-child(1){
    color: transparent;
}
.c_tran{
    color: transparent;
}
.c_608be9{
    color: #608be9;
}


.lineproc-yxb{
	background: #050d19;
	padding-top: 72px;
}
.lineproc-yxb-hed{
	height: 30px;
	padding:0 15px; 
}
.lineproc-yxb-hed h3{
    float: left;
    font-size: 16px;
    color: #e1e1e1;
    position: relative;
    line-height: 16px;
    font-weight: normal;
    padding-left: 10px;
}
.lineproc-yxb-hed h3:before{
    content: '|';
    position: absolute;
    left: 0px;
    border-left: 4px solid #648EDA;
    color: transparent;
}
.lineproc-yxb-hed a{
	float: right;
	color: #848ea4;
	font-size: 14px;
	line-height: 14px;
	letter-spacing: 1px;
}
.lineproc-yxb-hed a i{
    width: 7px;
    height: 13px;
    display: inline-block;
    background: url(../../images/ico_jt_2_@3x2.png) no-repeat;
    background-size: 100% 100%;
    vertical-align: middle;
}
.lineProc-jpc-box{
    position: relative;
    padding-top: 50px;
}
.lineProc-jpc{
    min-height: 28px;
    border-bottom: 1px solid #323e56;
    margin-bottom: 15px;
    padding: 0 7% 10px;

}
.lineProc-match-time{
    font-size: 12px;
    line-height: 12px;
    color: #848ea4;
    padding-top: 10px;
}
.lineProc-match-time i{
    display: inline-block;
    width: 10px;
    height: 13px;
    background: url(../../images/match_ico_4_@3x1.png) no-repeat;
    background-size: 100% 100%;
    margin-right: 5px;
    vertical-align: -2px;
}
.lineProc-match-time span{
    color: #fad83a
}

.lineProc-jpc-prize{
    width: 100%;
    min-height: 150px;
    position: relative;
    font-size: 10px;
    margin-bottom: 20px;
}
.lineProc-jpc-prize .prize{
    position: absolute;
    left: 0;
    top:0;
    width: 12%;
    text-align: center;
}
.lineProc-jpc-prize .prize i{
    display: inline-block;
    width: 14px;
    height: 18px;
    background: url(../../images/ico_jt_1.png) no-repeat;
    background-size: 100% 100%;
}
.lineProc-jpc-prize .prize p{
    
}
.lineProc-jpc-prize .prize p:nth-child(1){
    margin-bottom: 17px;
}
.lineProc-jpc-prize .prize p:nth-child(3){
    font-size: 12px;
}
.lineProc-jpc-prize .prize img{
    margin:0;
}
.lineProc-jpc-prize .prize p:nth-child(5){
    color: #efdf4d;
    margin-top:10px;
}
.lineProc-jpc-prize .prize5{
    left: 16.8%
}
.lineProc-jpc-prize .prize4{
    left: 40.5%
}
.lineProc-jpc-prize .prize3{
    left: 61.8%
}
.lineProc-jpc-prize .prize2{
    left: 76.6%
}
.lineProc-jpc-prize .prize1{
    left: 91.37%
}
.lineProc-jpc-bar {
    position: absolute;
    left: 0;
    top: 66px;
    width: 100%;
    height: 17px;
}
.lineProc-jpc-bar .bar2{
    width: 100%;
    height: 100%;
    background: url(../../images/ico_jt_4.png) no-repeat;
    background-size:100% 100%;
    overflow: hidden;
    padding:0 10px;
}
.lineProc-jpc-bar .bar2-1{
    width: 100%;
    height: 9px;
    background: url(../../images/ico_jt_3_022.png) no-repeat;
    background-size: auto 100%;
    margin-top:3px;
    position: relative;
}
.lineProc-jpc-bar .bar2-1:after{
    content: " ";
    width: 14px;
    height: 14px;
    background: url(../../images/ico_jt_2.png) no-repeat;
    background-size: 100% 100%;
    display: inline-block;
    position: absolute;
    right: -2px;
    top: -2px;
}
.lineProc-jpc-bar .bar1{
    text-align: center;
    font-size: 10px;
    color: #fad83a;
    width:12%;
    position: absolute;
    left: -3%;
    top: -48px;
}
.lineProc-jpc-bar .bar1 img{
    border-radius: 100%;
    display: inline-block;

}

.lineproc-yxb-list a.user-gameData-item{
    overflow: hidden;
    display: block;
    color: #e1e1e1;
    font-size: 12px;
}
.lineproc-yxb-list a.user-gameData-item:nth-child(2n+1){
	background: #111a2b;
}
.lineproc-yxb-list .c_ph_1{
    width: 24px;
    height: 24px;
    background: url(../../images/prank-ico-01.png) no-repeat;
    background-size: 100% 100%;
    vertical-align: middle;
    display: inline-block;
    font-size: 0;
}
.lineproc-yxb-list .c_ph_2{
    width: 24px;
    height: 24px;
    background: url(../../images/prank-ico-02.png) no-repeat;
    background-size: 100% 100%;
    vertical-align: middle;
    display: inline-block;
    font-size: 0;
}
.lineproc-yxb-list .c_ph_3{
    width: 24px;
    height: 24px;
    background: url(../../images/prank-ico-03.png) no-repeat;
    background-size: 100% 100%;
    vertical-align: middle;
    display: inline-block;
    font-size: 0;
}
.lineproc-yxb-list .item1 {
    padding-top: 11px;
    overflow: hidden;
}
.lineproc-yxb-list .user-img-text {
    margin-left: 10px;
    margin-top:10px;
    max-width: 100%;
    line-height: 12px;
}
.lineproc-yxb-list .c_font_b img{
	display: inline-block;
	vertical-align: middle;
}
.lineproc-yxb-list .c_font_a{
	color: #34a247
}
.lineproc-yxb-list  .tu-link i{
	width: 10px;
	height: 15px;
	display: inline-block;
	background: url(../../images/prank-ico.png) no-repeat;
	background-size: 100% 100%;
	vertical-align: middle;
}
.media-holder1{
    position: relative;
    width: 60px;
    min-height: 30px;
    width: 100%;
    display: block;
}
</style>
<template>

    <div class="season-tab">
        <childnav></childnav>
        <div class="season-tab-box">
            <div class="lineproc">
                <div class="lineproc-yxb">
                    <div class="lineproc-yxb-hed">
                        <h3>奖品池</h3>
                        <a v-if="userState==5 && datajfUsFn.length>0" v-link="{name:'mygame',query:{matchid:matchid,userid:userid}}">我的比赛详情<i></i></a>
                    </div>
                    <div class="lineProc-jpc">
                        <div class="lineProc-jpc-box">
                            <div class="lineProc-jpc-bar">
                                <div class="bar1"  v-if="datajfUsFn.length>0">
                                    <img :src=userLogo width="30px">
                                    <p>{{userScore}}{{rankRules}}</p>
                                </div>
                                <div class="bar2">
                                    <div class="bar2-1" style="width:1.4%"></div>
                                    <div class="bar2-2"></div>
                                </div>
                            </div>
                            <div class="lineProc-jpc-prize">
                                <div class="prize prize{{$index+1}}" v-for="item in datajfjpFn | limitBy 5">
                                    <p>{{item.score}}{{rankRules}}</p>
                                    <i></i>
                                    <p>{{item.name}}</p>
                                    <div style="position:relative;margin-top:5px;">
                                        <img src="../../images/media-holder.png" class="media-holder1">
                                        <img :src=item.image_url style="position:absolute;left:0;top:0;width:100%;height:100%;">
                                    </div>
                                    <p>{{item.remark}}</p> 
                                </div>
                                
                            </div>
                        </div>
                        <p class="lineProc-match-time" data-stime="{{startime}}" data-etime="{{endtime}}"></p>
                    </div>
                    <div v-if="userState==5 && datajfUsFn.length>0">
                        <div class="lineproc-yxb-hed">
                            <h3>英雄榜</h3>
                            <a v-link="{name:'gamerank',query:{matchid:matchid,userid:userid}}">查看更多<i></i></a>
                        </div>
                        <div class="lineproc-yxb-list" v-if="datayxblist.length>0">
                            <a  class="user-gameData-item"  v-for="list in datayxblist"  v-link="{name:'gamerank',query:{matchid:matchid,userid:list.uid}}">
                                <div class="fl tc m4 lh52 c_font_1">
                                    <span class="c_ph_1" v-if="list.rank == 1"></span>
                                    <span class="c_ph_2" v-if="list.rank == 2"></span>
                                    <span class="c_ph_3" v-if="list.rank == 3"></span>
                                    <span class="" v-if="list.rank > 3">{{list.rank}}</span>
                                </div>
                                <div class="fl m1 item1">
                                    <div class="fl tu_m">
                                        <img width="32" height="32" alt="" class="img" :src=list.logo>
                                    </div>
                                    <div class="user-img-text user_name fl">
                                        <span class="fl">{{list.rolename}}</span>
                                    </div> 
                                </div>
                                <div class="fl tl lh52 m2">{{list.servicename}}</div>
                                <div class="fl tc lh52 m2 c_font_a">{{list.score}}</div>
                                <div class="fl tc lh52 m10 c_font_b"  v-if="list.rank <= 3">
                                    <img :src="list.price " width="32px">
                                </div>
                                <div class="fr tc lh52 m4 c_font_b tu-link"><i></i></div> 
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
        
</template>

<script>
var Vue = require('Vue');
var nav = require('./nav.vue');
var $ = require('jQuery');
var common = require('../../js/common.js');

module.exports = {
    data : function() {
        return {
            channelid : wsCache.get('HEROC').channelid,
            matchid : wsCache.get('HEROC').matchid,
            userid : gload_conf.uid,
            datayxblist:[],
            datajfjpFn:[],
            datajfUsFn:[],
            userScore : 0,
            userState:'',
            userRank : '',
            state : '',
            status : '',
            startime : '',
            endtime : '',
            userLogo : '',
            rankRules : ''
        };
    },
    components:{
        'childnav':nav
    },
    ready: function() {
        this.yxbFn();
        this.startime = wsCache.get('HEROC').startime;
        this.endtime = wsCache.get('HEROC').endtime;
        if(wsCache.get('HEROC').enroll==1){
            wsCache.set('procA',{status:true});
            this.status = wsCache.get('procA').status;
        }else{
            wsCache.set('procA',{status:false});
            this.status = wsCache.get('procA').status;
        }
        if($(".season-tab-box").height() > ($(window).height()-63)){
            common.scroll(function(direction){
                if(direction=="down"){
                    $(".season-tab-hed1,.season-tab-hed").css("top","-62px");
                }else{
                    $(".season-tab-hed1,.season-tab-hed").css("top","0");
                }
            }); 
        };
    },
    methods: {
        yxbFn:function(){
            var self = this;
            $.ajax({
                url:common.getBaseUrl()+'/match/matchresult.lg'+QUERY,
                type:"POST",
                data:{match_id:self.matchid},
                dataType:"json",
                beforeSend:function(){
                    $(".loading-1").show();
                },
                success:function(data){
                    if(data.code==0){
                        self.datayxblist = self.datayxblist.concat(data.data.billboard);
                        self.datajfjpFn = self.datajfjpFn.concat(data.data.price).reverse();
                        self.datajfUsFn = self.datajfUsFn.concat(data.data.user);
                        self.userState = data.data.state;
                        self.userScore = data.data.user.score ? data.data.user.score : 0;
                        self.userRank = data.data.user.rank ? data.data.user.rank : 0;
                        self.userLogo = data.data.user.logo ? data.data.user.logo : "";
                        self.rankRules = gload_conf.rankRules[data.data.rank_rules].name;
                        if(self.userRank==0){
                            setTimeout(function(){
                                $(".bar2-1").css("width","1.4%");
                                $(".bar1").css("left","-3%");
                            },50);
                        }else if(self.userRank > parseInt(self.datajfjpFn[4].section)){
                            setTimeout(function(){
                                $(".bar2-1").css("width","11.4%");
                                $(".bar1").css("left","6.9%");
                            },50);
                        }else if(self.userRank == parseInt(self.datajfjpFn[4].section)){
                            setTimeout(function(){
                                $(".bar2-1").css("width","22.8%");
                                $(".lineProc-jpc-prize .prize5 p").eq(0).css("color","#efdf4d");
                                $(".bar1 > p").addClass("c_tran");
                                $(".bar1").css("left","16.9%");
                            },50);
                        }else if(self.userRank< parseInt(self.datajfjpFn[4].section) && self.userRank> parseInt(self.datajfjpFn[3].section)){
                               setTimeout(function(){
                                   $(".bar2-1").css("width","36.7%");
                                    $(".bar1").css("left","30.5%");
                                },50);
                        }else if(self.userRank == parseInt(self.datajfjpFn[3].section)){
                                setTimeout(function(){
                                    $(".bar2-1").css("width","47.2%");
                                    $(".lineProc-jpc-prize .prize4 p").eq(0).css("color","#efdf4d");
                                    $(".bar1 > p").addClass("c_tran");
                                    $(".bar1").css("left","40.5%");
                                },50);
                        }else if(self.userRank>3 && self.userRank < parseInt(self.datajfjpFn[3].section)){
                                setTimeout(function(){
                                    $(".bar2-1").css("width","58.2%");
                                    $(".bar1").css("left","51.5%");
                                },50);
                        }else if(self.userRank==3){
                                 setTimeout(function(){
                                    $(".bar2-1").css("width","69.3%");
                                    $(".lineProc-jpc-prize .prize3 p").eq(0).css("color","#efdf4d");
                                    $(".bar1 > p").addClass("c_tran");
                                    $(".bar1").css("left","62%");
                                },50);
                      
                        }else if(self.userRank==2){
                                 setTimeout(function(){
                                    $(".bar2-1").css("width","84.6%");
                                    $(".lineProc-jpc-prize .prize2 p").eq(0).css("color","#efdf4d");
                                    $(".bar1 > p").addClass("c_tran");
                                    $(".bar1").css("left","76.6%");
                                },50);
                        }else if(self.userRank==1){
                                setTimeout(function(){
                                    $(".bar2-1").css("width","99.9%");
                                    $(".lineProc-jpc-prize .prize1 p").eq(0).css("color","#efdf4d");
                                    $(".bar1 > p").addClass("c_tran");
                                    $(".bar1").css("left","92%");
                                },50);
                        }
                        
                        $(".loading-1").hide();
                    }else if(data.code <0){
                        
                    }
                    
                }
            })
        }
    }
};

</script>